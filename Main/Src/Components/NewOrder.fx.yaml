NewOrder As CanvasComponent:
    Customer: =First('Item Pricing lines')
    Fill: =_VarGblAppColors.BackgroundColor
    Height: =900
    Width: =App.Width
    X: =0
    Y: =0
    ZIndex: =1

    contNewOrderUpperVertical As groupContainer.verticalAutoLayoutContainer:
        Height: =525
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        Width: =App.Width
        ZIndex: =1

        contNewOrderUpper As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =978
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Width: =Parent.Width
            ZIndex: =1

            contNewOrderLowerVertical As groupContainer.verticalAutoLayoutContainer:
                Height: =906
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                Width: =Parent.Width
                Y: =6
                ZIndex: =1

                contNewOrderHeader As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =60
                    LayoutMinHeight: =60
                    LayoutMinWidth: =250
                    Width: =App.Width
                    ZIndex: =1

                    btnNewOrderHeaderProduct As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Subtitle
                        Text: ="Product"
                        Width: =220
                        X: =5
                        ZIndex: =1

                    btnNewOrderHeaderCases As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Regular
                        Text: ="Stock (Cases)"
                        Width: =77
                        X: =btnNewOrderHeaderProduct.X + btnNewOrderHeaderProduct.Width +5
                        ZIndex: =2

                    btnNewOrderHeaderPcs As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Regular
                        Text: ="Stock (Pcs)"
                        Width: =77
                        X: =btnNewOrderHeaderCases.X + btnNewOrderHeaderCases.Width +5
                        ZIndex: =3

                    btnNewOrderHeaderReceivedEmptyJar As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Subtitle
                        Text: ="Cases"
                        Width: =77
                        X: =btnNewOrderHeaderPcs.X + btnNewOrderHeaderPcs.Width +5
                        ZIndex: =4

                    btnNewOrderHeaderCases_22 As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Subtitle
                        Text: ="Pcs"
                        Width: =77
                        X: =btnNewOrderHeaderReceivedEmptyJar.X + btnNewOrderHeaderReceivedEmptyJar.Width +5
                        ZIndex: =5

                    btnNewOrderHeaderPcs_18 As button:
                        DisabledBorderColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.BisleriBlue
                        DisabledColor: |-
                            =//RGBA(166, 166, 166, 1)
                            _VarGblAppColors.LightText
                        DisabledFill: |-
                            =//RGBA(244, 244, 244, 1)
                            _VarGblAppColors.BisleriBlue
                        DisplayMode: =DisplayMode.Disabled
                        Height: =50
                        OnSelect: =
                        Size: =_VarGblAppFonts.Size.Tiny
                        Text: ="Received Empty Jar"
                        Width: =77
                        X: =btnNewOrderHeaderCases_22.X + btnNewOrderHeaderCases_22.Width +5
                        ZIndex: =6

                contNewOrderData As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =461
                    LayoutMinHeight: =570
                    LayoutMinWidth: =640
                    LayoutMode: =LayoutMode.Auto
                    Width: =contNewOrderHeader.Width
                    ZIndex: =3

                    galNewOrderProduct As gallery.galleryVertical:
                        AccessibleLabel: ="galNewOrderProduct"
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: |-
                            =//RGBA(0, 0, 0, 0)
                            _VarGblAppColors.BackgroundColor
                        FillPortions: =0
                        FocusedBorderColor: =Color.Transparent
                        FocusedBorderThickness: =0.2
                        Height: =450
                        Items: |-
                            =Filter(
                                'Current Stocks',
                                'Created Date'>=Today() && 'Van No'.Warehouse = varUserVanNo.Van.Warehouse
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =460
                        LayoutMinWidth: =1200
                        ShowScrollbar: =false
                        TabIndex: =0
                        TemplateSize: =100
                        Width: =contNewOrderHeader.Width
                        ZIndex: =1

                        btnNewOrderDataBackground As button:
                            DisabledBorderColor: =RGBA(179, 179, 179, 1)
                            DisabledFill: |-
                                =//RGBA(244, 244, 244, 1)
                                ColorFade( _VarGblAppColors.BisleriBlue, 80%)
                            DisplayMode: =DisplayMode.Disabled
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Size: =24
                            Text: =""
                            Width: =Parent.Width-10
                            ZIndex: =1

                        lblNewOrderProductCode As label:
                            Align: =Align.Center
                            Color: =_VarGblAppColors.BisleriBlue
                            FontWeight: =FontWeight.Bold
                            Height: =60
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.UpperMedium
                            Text: |-
                                =Concatenate(
                                    ThisItem.'Item SKU'.'Pack Title',
                                    " MRP",
                                    If(
                                        IsBlank(
                                            LookUp(
                                                varOfflinePricingLines,
                                                'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                            ).'Sales Price'
                                        ),
                                        LookUp(
                                            varOfflinePricingLines,
                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).MRP,
                                        LookUp(
                                            varOfflinePricingLines,
                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).'Sales Price'
                                    )
                                )
                            Width: =220
                            ZIndex: =2

                        txtNewOrderPcs As text:
                            AccessibleLabel: ="txtNewOrderActualDel"
                            Align: =Align.Center
                            BorderColor: |-
                                =//RGBA(0, 18, 107, 1)
                                ColorFade( _VarGblAppColors.BisleriBlue, -30%)
                            Default: |-
                                =/*If(
                                    LookUp(
                                        'Item Masters',
                                        'Item Master' = LookUp(
                                            'SKU Masters',
                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).'Item Code'.'Item Master'
                                    ).UOM = 'UOM (Item Masters)'.PCs,
                                    LookUp(
                                        colCartItems,
                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                    ).qtyPcs
                                )*/
                                LookUp(
                                        colCartItems,
                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false
                                    ).qtyPcs
                            DisplayMode: |-
                                =/*If(
                                    LookUp(
                                        'Item Masters',
                                        'Item Master' = LookUp(
                                            'SKU Masters',
                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).'Item Code'.'Item Master'
                                    ).UOM = 'UOM (Item Masters)'.PCs,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )*/
                                If(
                                    varLoading,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            FocusedBorderThickness: =2
                            FontWeight: =FontWeight.Semibold
                            Format: =TextFormat.Number
                            Height: =50
                            HoverBorderColor: =ColorFade( _VarGblAppColors.BisleriBlue, 30%)
                            HoverFill: |-
                                =//RGBA(186, 202, 226, 1)
                                ColorFade(_VarGblAppColors.BisleriBlue, 100%)
                            OnChange: |
                                =Set(
                                    varLoading,
                                    true
                                );
                                Set(
                                    varHSN,
                                    LookUp(
                                        'SKU Masters',
                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                    ).'HSN Code'.'HSN Code'
                                );
                                Set(
                                    varVisit,
                                    LookUp(
                                        colOfflineVisitOrderHeader,
                                        Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                    ).'Order Id'
                                );
                                ClearCollect(
                                    colSKU,
                                    AddColumns(
                                        Filter(
                                            'Current Stocks',
                                            'Created On' <= Today() && 'Van No'.Warehouse = varUserVanNo.Van.Warehouse
                                        ),
                                        "skuID",
                                        'Item SKU'.'SKU Master'
                                    ).skuID
                                );
                                If(
                                    Self.Text <> "" And Value(Self.Text) <> RoundDown(
                                        Value(Self.Text),
                                        0
                                    ) Or Value(Self.Text) < 0,
                                    Notify(
                                        "Please enter whole number",
                                        NotificationType.Information,
                                        1000
                                    );
                                    Reset(Self),
                                    If(
                                        Self.Text = "" && (Text(
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            ).qtyCases
                                        ) = "" || Value(
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            ).qtyCases
                                        ) = 0),
                                        Remove(
                                            colCartItems,
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            )
                                        );
                                        Remove(
                                            colCartItems,
                                            LookUp(
                                                colCartItems,
                                                SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = true && childInvoice = false
                                            )
                                        );
                                        Remove(
                                            colChildInvoiceLine,
                                            LookUp(
                                                colChildInvoiceLine,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true
                                            )
                                        );
                                        Remove(
                                            colChildInvoiceLine,
                                            LookUp(
                                                colChildInvoiceLine,
                                                SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = true && childInvoice = true
                                            )
                                        );
                                        Remove(
                                            'Order Lines',
                                            LookUp(
                                                'Order Lines',
                                                'Order Number'.'Order Id' = varVisit 
                                                /*LookUp(
                                                    colOfflineVisitOrderHeader,
                                                    Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                                ).'Order Id'*/&& 'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Paid
                                            )
                                        );
                                        Remove(
                                            'Invoice Lines',
                                            LookUp(
                                                'Invoice Lines',
                                                'Order Number'.'Order Id' = varVisit 
                                                /*LookUp(
                                                    colOfflineVisitOrderHeader,
                                                    Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                                ).'Order Id' */&& 'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Paid
                                            )
                                        ),
                                        If(
                                            (Value(Self.Text) <= ((ThisItem.PCs) + (LookUp(
                                                'Item UOMS',
                                                SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                            ).'Quantity Per UOM' * ThisItem.Cases))),
                                            If(
                                                !IsBlank(
                                                    LookUp(
                                                        colCartItems,
                                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                                    )
                                                ),
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: If(
                                                            IsBlank(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                                ).'Sales Price'
                                                            ),
                                                            Round(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                                ).'Sales Price' / LookUp(
                                                                    'Item UOMS',
                                                                    SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                                ).'Quantity Per UOM',
                                                                0
                                                            ),
                                                            LookUp(
                                                                varOfflinePricingLines,
                                                                'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                            ).'Sales Price'
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        )
                                                    },
                                                    Patch(
                                                        colCartItems,
                                                        LookUp(
                                                            colCartItems,
                                                            productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                                        ),
                                                        {
                                                            childInvoice: false,
                                                            qtyPcs: Value(Self.Text),
                                                            pcsPrice: PriceLine * Value(Self.Text),
                                                            pcsUnitPrice: PriceLine,
                                                            price: (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).casesPrice) + (PriceLine * Value(Self.Text)),
                                                            discountPcs: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discount: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountCases) + (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            ))),
                                                            discountedPricePcs: ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))),
                                                            discountedPrice: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            taxAmount: ((((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01),
                                                            cessValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cess * 0.01,
                                                            cgstValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cgst * 0.01,
                                                            sgstValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).sgst * 0.01,
                                                            netAmount: ((((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))))) + (((((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (((((LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) + (((((LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) * LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) - LookUp(
                                                                        colCartItems,
                                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).emptyJar) * 150,
                                                                    0
                                                                ))) - ((Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150),
                                                                ((((LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) + (((((LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).discountedPriceCases) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) * LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) - LookUp(
                                                                        colCartItems,
                                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).emptyJar) * 150,
                                                                    0
                                                                ))
                                                            )
                                                        }
                                                    );
                                                );
                                                ,
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: If(
                                                            IsBlank(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                                ).'Sales Price'
                                                            ),
                                                            Round(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                                ).'Sales Price' / LookUp(
                                                                    'Item UOMS',
                                                                    SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                                ).'Quantity Per UOM',
                                                                1
                                                            ),
                                                            LookUp(
                                                                varOfflinePricingLines,
                                                                'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                            ).'Sales Price'
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        ),
                                                        taxStructure: LookUp(
                                                            'HSN Masters' As ItemHsn,
                                                            ItemHsn.'HSN Code' = varHSN
                                                            /*LookUp(
                                                                'SKU Masters',
                                                                'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                            ).'HSN Code'.'HSN Code'*/
                                                        )
                                                    },
                                                    Collect(
                                                        colCartItems,
                                                        {
                                                            childInvoice: false,
                                                            productId: ThisItem.'Item SKU'.'SKU Master',
                                                            qtyPcs: Value(Self.Text),
                                                            qtyCases: Value(""),
                                                            caseUnitPrice: 0,
                                                            pcsUnitPrice: PriceLine,
                                                            discount: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discountPcs: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discountCases: "0",
                                                            maxQty: DiscountLine.'Maximum Quantity',
                                                            pcsPrice: PriceLine * Value(Self.Text),
                                                            casesPrice: 0,
                                                            price: PriceLine * Value(Self.Text),
                                                            discountedPricePcs: (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))),
                                                            discountedPriceCases: 0,
                                                            discountedPrice: (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            schemeOrder: false,
                                                            uom: "PCS",
                                                            schemeOrderValue: Blank(),
                                                            tax: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ),
                                                            cess: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            ),
                                                            sgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            ),
                                                            cgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            ),
                                                            cessValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            cgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            sgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            taxAmount: ((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01),
                                                            netAmount: (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                ((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01))) * (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                )) * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) * 150),
                                                                    0
                                                                ))) - ((Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150),
                                                                (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01))) * (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                )) * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) * 150),
                                                                    0
                                                                ))
                                                            )
                                                        }
                                                    );
                                                )
                                            );
                                            If(
                                                !IsBlank(
                                                    LookUp(
                                                        colChildInvoiceLine,
                                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true && qtyPcs <> "" && (qtyCases=Value("") || qtyCases=0)
                                                    )
                                                ),
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: If(
                                                            IsBlank(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                                ).'Sales Price'
                                                            ),
                                                            Round(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                                ).'Sales Price' / LookUp(
                                                                    'Item UOMS',
                                                                    SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                                ).'Quantity Per UOM',
                                                                0
                                                            ),
                                                            LookUp(
                                                                varOfflinePricingLines,
                                                                'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                            ).'Sales Price'
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        )
                                                    },
                                                    Patch(
                                                        colChildInvoiceLine,
                                                        LookUp(
                                                            colChildInvoiceLine,
                                                            productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true && qtyPcs <> "" && (qtyCases=Value("") || qtyCases=0)
                                                        ),
                                                        {
                                                            childInvoice: true,
                                                            qtyPcs: Value(Self.Text),
                                                            pcsPrice: PriceLine * Value(Self.Text),
                                                            pcsUnitPrice: PriceLine,
                                                            price: PriceLine * Value(Self.Text),
                                                            discountPcs: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discount: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discountedPricePcs: ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))),
                                                            discountedPrice: ((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            taxAmount: (((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01),
                                                            cessValue: ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cess * 0.01,
                                                            cgstValue: ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cgst * 0.01,
                                                            sgstValue: ((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).sgst * 0.01,
                                                            netAmount: ((((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))))) + (((((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (((((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) + (((((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) * LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) - LookUp(
                                                                        colChildInvoiceLine,
                                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).emptyJar) * 150,
                                                                    0
                                                                ))) - ((Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150),
                                                                ((((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) + (((((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01))))))) * LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).tax * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) - LookUp(
                                                                        colChildInvoiceLine,
                                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).emptyJar) * 150,
                                                                    0
                                                                ))
                                                            )
                                                        }
                                                    );
                                                );
                                                ,
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: If(
                                                            IsBlank(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                                ).'Sales Price'
                                                            ),
                                                            Round(
                                                                LookUp(
                                                                    varOfflinePricingLines,
                                                                    'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                                ).'Sales Price' / LookUp(
                                                                    'Item UOMS',
                                                                    SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                                ).'Quantity Per UOM',
                                                                1
                                                            ),
                                                            LookUp(
                                                                varOfflinePricingLines,
                                                                'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                            ).'Sales Price'
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        ),
                                                        taxStructure: LookUp(
                                                            'HSN Masters' As ItemHsn,
                                                            ItemHsn.'HSN Code' = varHSN
                                                            /*LookUp(
                                                                'SKU Masters',
                                                                'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                            ).'HSN Code'.'HSN Code'*/
                                                        )
                                                    },
                                                    Collect(
                                                        colChildInvoiceLine,
                                                        {
                                                            childInvoice: true,
                                                            productId: ThisItem.'Item SKU'.'SKU Master',
                                                            qtyPcs: Value(Self.Text),
                                                            qtyCases: Value(""),
                                                            caseUnitPrice: 0,
                                                            pcsUnitPrice: PriceLine,
                                                            discount: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discountPcs: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                )
                                                            )),
                                                            discountCases: "0",
                                                            maxQty: DiscountLine.'Maximum Quantity',
                                                            pcsPrice: PriceLine * Value(Self.Text),
                                                            casesPrice: 0,
                                                            price: PriceLine * Value(Self.Text),
                                                            discountedPricePcs: (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))),
                                                            discountedPriceCases: 0,
                                                            discountedPrice: (((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            schemeOrder: false,
                                                            uom: "PCS",
                                                            schemeOrderValue: Blank(),
                                                            tax: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ),
                                                            cess: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            ),
                                                            sgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            ),
                                                            cgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            ),
                                                            cessValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            cgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            sgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            )) * 0.01) * ((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            taxAmount: ((((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01),
                                                            netAmount: (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                ((((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01))) * (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                )) * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) * 150),
                                                                    0
                                                                ))) - ((Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150),
                                                                (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01)))) + (((((PriceLine * Value(Self.Text)) - Value(
                                                                    If(
                                                                        OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                        "0",
                                                                        OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                        If(
                                                                            Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                            (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                            (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                        )
                                                                    )
                                                                )) / (1 + (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                ) * 0.01))) * (If(
                                                                    LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                    (LookUp(
                                                                        colOfflineVariantMaster,
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Exceptional Tax %'),
                                                                    (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                                )) * 0.01)) + If(
                                                                    LookUp(
                                                                        'SKU Masters',
                                                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                    (Value(Self.Text) * 150),
                                                                    0
                                                                ))
                                                            )
                                                        }
                                                    );
                                                )
                                            );
                                     //____________________________________________________________________________________________________________
                                If(
                                                CountRows(colSchemeApplicability) > 0,
                                                Collect(
                                                    colSchemeOrder,
                                                    Sort(
                                                        Filter(
                                                            'Scheme Orders',
                                                            ('Scheme Code'.'Scheme Header' in/*AddColumns(
                                                                colSchemeHeader,
                                                                "SchemeCode",
                                                                'Scheme Header'
                                                            ).SchemeCode*/ AddColumns(
                                                                colSchemeApplicability,
                                                                "SchemeCode",
                                                                'Scheme Code'.'Scheme Header'
                                                            ).SchemeCode) && ('Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master') 
                                                      //  && ('Ordered Quantity' <= Value(Self.Text)) 
                                && ('Ordered UOM' = 'UOM Choice'.PCS)
                                                        ),
                                                        'Ordered Quantity',
                                                        SortOrder.Ascending
                                                    )
                                                )
                                            );
                                            ForAll(
                                                colSchemeOrder As ThissItemm,
                                                If(
                                                    CountRows(colFinalSchemeOrder) = 0,
                                                    If(
                                                        (ThissItemm.'Ordered Quantity' = Value(Self.Text)),
                                                        Collect(
                                                            colFinalSchemeOrder,
                                                            ThissItemm
                                                        )
                                                    )
                                                )
                                            );
                                            If(
                                                CountRows(colFinalSchemeOrder) = 0,
                                                ForAll(
                                                    colSchemeOrder As ThissItemm,
                                                    If(
                                                        CountRows(colFinalSchemeOrder) = 0,
                                                        If(
                                                            (ThissItemm.'Ordered Quantity' < Value(Self.Text)),
                                                            Collect(
                                                                colFinalSchemeOrder,
                                                                Index(
                                                                    Sort(
                                                                        Filter(
                                                                            colSchemeOrder,
                                                                            'Ordered Quantity' < Value(Self.Text)
                                                                        ),
                                                                        'Ordered Quantity',
                                                                        SortOrder.Descending
                                                                    ),
                                                                    1
                                                                )
                                                            )
                                                        )
                                                    )
                                                );
                                            );
                                    //_________________________________________________________________________________________________________________
                                If(
                                                Not(CountRows(colFinalSchemeOrder) = 0),
                                                ForAll(
                                                    colFinalSchemeOrder As item,
                                                    Collect(
                                                        colSchemeOffers,
                                                        Filter(
                                                            'Scheme Offers',
                                                            ('Scheme Code'.'Scheme Header' in AddColumns(
                                                                colSchemeHeader,
                                                                "SchemeCode",
                                                                'Scheme Header'
                                                            ).SchemeCode) && ('Scheme Order'.'Scheme Order' in AddColumns(
                                                                colFinalSchemeOrder,
                                                                "SchemeOrder",
                                                                'Scheme Order'
                                                            ).SchemeOrder) && ('Offer Item Code'.'SKU Master' in colSKU
                                                            /*AddColumns(
                                                                Filter(
                                                                    'Current Stocks',
                                                                    'Created On' <= Today() && 'Van No'.Warehouse = varUserVanNo.Van.Warehouse
                                                                )
                                                                ,
                                                                "skuID",
                                                                'Item SKU'.'SKU Master'
                                                            ).skuID*/)
                                                        )
                                                    )
                                                );
                                                
                                //________________________________________________________________________________________________________________________
                                If(
                                                    Not(CountRows(colSchemeOffers) = 0),
                                                    ForAll(
                                                        Table(/*First(colSchemeOffers)*/
                                                            Index(
                                                                colSchemeOffers,
                                                                1
                                                            )
                                                        ) As ThisItemmmm,
                                                        If(
                                                            IsBlank(
                                                                LookUp(
                                                                    colCartItems,
                                                                    childInvoice = false && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                )
                                                            ),
                                                            Collect(
                                                                colCartItems,
                                                                {
                                                                    childInvoice: false,
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    discount: "0",
                                                                    maxQty: 0,
                                                                    price: 0,
                                                                    discountedPrice: 0,
                                                                    emptyJar: Value(""),
                                                                    emptyJarValue: 0,
                                                                    schemeOrder: true,
                                                                    uom: Text(ThisItemmmm.'Offer UOM'),
                                                                    schemeOrderValue: ThisItemmmm,
                                                                    tax: 0,
                                                                    cess: 0,
                                                                    SchemeOrderLine: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ),
                                                                    SchemeOrderProductReference: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                }
                                                            );
                                                            Collect(
                                                                colChildInvoiceLine,
                                                                {
                                                                    childInvoice: true,
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    discount: "0",
                                                                    maxQty: 0,
                                                                    price: 0,
                                                                    discountedPrice: 0,
                                                                    emptyJar: Value(""),
                                                                    emptyJarValue: 0,
                                                                    schemeOrder: true,
                                                                    uom: Text(ThisItemmmm.'Offer UOM'),
                                                                    schemeOrderValue: ThisItemmmm,
                                                                    tax: 0,
                                                                    cess: 0,
                                                                    SchemeOrderLine: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ),
                                                                    SchemeOrderProductReference: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                }
                                                            ),
                                                            Patch(
                                                                colCartItems,
                                                                LookUp(
                                                                    colCartItems,
                                                                    childInvoice = false && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                ),
                                                                {
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    )
                                                                }
                                                            );
                                                            Patch(
                                                                colChildInvoiceLine,
                                                                LookUp(
                                                                    colChildInvoiceLine,
                                                                    childInvoice = true && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                ),
                                                                {
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    );
                                                );
                                                Clear(colSchemeOffers);
                                                Clear(colSchemeOrder);
                                                Clear(colFinalSchemeOrder);
                                                ,
                                                Remove(
                                                    colCartItems,
                                                    LookUp(
                                                        colCartItems,
                                                        childInvoice = false && schemeOrder = true && SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && SchemeOrderLine.'Ordered UOM' = 'UOM Choice'.PCS
                                                    )
                                                );
                                                Remove(
                                                    colChildInvoiceLine,
                                                    LookUp(
                                                        colChildInvoiceLine,
                                                        childInvoice = true && schemeOrder = true && SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && SchemeOrderLine.'Ordered UOM' = 'UOM Choice'.PCS
                                                    )
                                                );
                                                Remove(
                                                    'Order Lines',
                                                    LookUp(
                                                        'Order Lines',
                                                        'Order Number'.'Order Id' = varVisit 
                                                        /*LookUp(
                                                            colOfflineVisitOrderHeader,
                                                            Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                                        ).'Order Id'*/
                                && 'Scheme Parent Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Free && 'Scheme Order Item'.'Ordered UOM' = 'UOM Choice'.PCS
                                                    )
                                                );
                                                Remove(
                                                    'Invoice Lines',
                                                    LookUp(
                                                        'Invoice Lines',
                                                        'Order Number'.'Order Id' = varVisit 
                                                        /*LookUp(
                                                            colOfflineVisitOrderHeader,
                                                            Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                                        ).'Order Id'*/&& 'Scheme Parent Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Free && 'Scheme Order Item'.'Ordered UOM' = 'UOM Choice'.PCS
                                                    )
                                                );
                                            );
                                            Clear(colSchemeOffers);
                                            Clear(colSchemeOrder);
                                            Clear(colFinalSchemeOrder);
                                            ,
                                            Notify(
                                                "You are entering an invalid quantity. Please enter a quantity which is available in the stock",
                                                NotificationType.Error,
                                                2000
                                            );
                                            Reset(txtNewOrderPcs);
                                        );
                                    )
                                );
                                Set(
                                    varLoading,
                                    false
                                );
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Subtitle
                            Width: =65
                            X: =477
                            Y: =24
                            ZIndex: =6

                        txtNewOrderRecEmpty As text:
                            AccessibleLabel: ="txtNewOrderRecEmpty"
                            Align: =Align.Center
                            BorderColor: |-
                                =//RGBA(0, 18, 107, 1)
                                ColorFade( _VarGblAppColors.BisleriBlue, -30%)
                            Default: |-
                                =/*If(
                                    LookUp(
                                        'Item Masters',
                                        'Item Master' = LookUp(
                                            'SKU Masters',
                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).'Item Code'.'Item Master'
                                    ).UOM = 'UOM (Item Masters)'.Cases,
                                    LookUp(
                                        colCartItems,
                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                    ).qtyCases
                                )*/
                                LookUp(
                                        colCartItems,
                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false
                                    ).qtyCases
                            DisplayMode: |-
                                =/*If(
                                    LookUp(
                                        'Item Masters',
                                        'Item Master' = LookUp(
                                            'SKU Masters',
                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                        ).'Item Code'.'Item Master'
                                    ).UOM = 'UOM (Item Masters)'.Cases,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )*/
                                If(
                                    varLoading || LookUp(
                                        'SKU Masters',
                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            FocusedBorderThickness: =2
                            FontWeight: =FontWeight.Semibold
                            Format: =TextFormat.Number
                            Height: =50
                            HoverBorderColor: =ColorFade( _VarGblAppColors.BisleriBlue, 30%)
                            HoverFill: |-
                                =//RGBA(186, 202, 226, 1)
                                ColorFade(_VarGblAppColors.BisleriBlue, 100%)
                            OnChange: |
                                =Set(
                                    varLoading,
                                    true
                                );
                                Set(
                                    collorderheaderdata,
                                    LookUp(
                                        colOfflineVisitOrderHeader,
                                        Vists.'Visit ID' = First(VisitData).'Visit ID' && !IsBlank(Vists.'Visit ID')
                                    )
                                );
                                Set(
                                    varHSN,
                                    LookUp(
                                        'SKU Masters',
                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                    ).'HSN Code'.'HSN Code'
                                );
                                If(
                                    Self.Text <> "" And Value(Self.Text) <> RoundDown(
                                        Value(Self.Text),
                                        0
                                    ) Or Value(Self.Text) < 0,
                                    Notify(
                                        "Please enter whole number",
                                        NotificationType.Information,
                                        1000
                                    );
                                    Reset(Self),
                                    If(
                                        Self.Text = "" && (Text(
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            ).qtyPcs
                                        ) = "" || Value(
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            ).qtyPcs
                                        ) = 0),
                                        Remove(
                                            colCartItems,
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                            )
                                        );
                                        Remove(
                                            colCartItems,
                                            LookUp(
                                                colCartItems,
                                                SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = true && childInvoice = false
                                            )
                                        );
                                        Remove(
                                            colChildInvoiceLine,
                                            LookUp(
                                                colChildInvoiceLine,
                                                productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true
                                            )
                                        );
                                        Remove(
                                            colChildInvoiceLine,
                                            LookUp(
                                                colChildInvoiceLine,
                                                SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = true && childInvoice = true
                                            )
                                        );
                                        Remove(
                                            'Order Lines',
                                            LookUp(
                                                'Order Lines',
                                                'Order Number'.'Order Id' = collorderheaderdata.'Order Id' && 'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Paid
                                            )
                                        );
                                        Remove(
                                            'Invoice Lines',
                                            LookUp(
                                                'Invoice Lines',
                                                'Order Number'.'Order Id' = collorderheaderdata.'Order Id' && 'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Paid
                                            )
                                        ),
                                        If(
                                            Value(Self.Text) <= ThisItem.Cases,
                                            If(
                                                !IsBlank(
                                                    LookUp(
                                                        colCartItems,
                                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                                    )
                                                ),
                                        ///////////////////////////////////////////////////_____________________ Update collection
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        )
                                                    },
                                                    Patch(
                                                        colCartItems,
                                                        LookUp(
                                                            colCartItems,
                                                            productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = false
                                                        ),
                                                        {
                                                            childInvoice: false,
                                                            qtyCases: Value(Self.Text),
                                                            casesPrice: PriceLine.'Sales Price' * Value(Self.Text),
                                                            caseUnitPrice: PriceLine.'Sales Price',
                                                            price: LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).pcsPrice + PriceLine.'Sales Price' * Value(Self.Text),
                                                            discountCases: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            discount: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountPcs) + ((If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )))),
                                                            discountedPriceCases: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))),
                                                            discountedPrice: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + ((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            taxAmount: (((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + ((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01),
                                                            cessValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cess * 0.01,
                                                            cgstValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cgst * 0.01,
                                                            sgstValue: ((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).sgst * 0.01,
                                                            netAmount: (((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) + ((((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: (((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) + ((((LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).discountedPricePcs) + (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colCartItems,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ))
                                                        }
                                                    );
                                                );
                                                ,
                                             ///////////////////////////////////////////////////_____________________ Create collection
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        ),
                                                        taxStructure: LookUp(
                                                            'HSN Masters' As ItemHsn,
                                                            ItemHsn.'HSN Code' = varHSN/*LookUp(
                                                                'SKU Masters',
                                                                'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                            ).'HSN Code'.'HSN Code'*/
                                                        )
                                                    },
                                                    Collect(
                                                        colCartItems,
                                                        {
                                                            childInvoice: false,
                                                            productId: ThisItem.'Item SKU'.'SKU Master',
                                                            qtyCases: Value(Self.Text),
                                                            caseUnitPrice: PriceLine.'Sales Price',
                                                            pcsUnitPrice: 0,
                                                            qtyPcs: Value(""),
                                                            discountPcs: "0",
                                                            discountCases: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            discount: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            maxQty: DiscountLine.'Maximum Quantity',
                                                            casesPrice: PriceLine.'Sales Price' * Value(Self.Text),
                                                            pcsPrice: 0,
                                                            price: PriceLine.'Sales Price' * Value(Self.Text),
                                                            discountedPrice: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))),
                                                            discountedPriceCases: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))),
                                                            discountedPricePcs: 0,
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colCartItems,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            schemeOrder: false,
                                                            uom: "Cases",
                                                            schemeOrderValue: Blank(),
                                                            tax: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ),
                                                            cess: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            ),
                                                            sgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            ),
                                                            cgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            ),
                                                            cessValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            cgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            sgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            taxAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01),
                                                            netAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) + (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) + (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            ))
                                                        }
                                                    );
                                                )
                                            );
                                            If(
                                                !IsBlank(
                                                    LookUp(
                                                        colChildInvoiceLine,
                                                        productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true && qtyCases <> "" && (qtyPcs=Value("") || qtyPcs=0)
                                                    )
                                                ),
                                        ///////////////////////////////////////////////////_____________________ Update collection
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        )
                                                    },
                                                    Patch(
                                                        colChildInvoiceLine,
                                                        LookUp(
                                                            colChildInvoiceLine,
                                                            productId = ThisItem.'Item SKU'.'SKU Master' && schemeOrder = false && childInvoice = true && qtyCases <> "" && (qtyPcs=Value("") || qtyPcs=0)
                                                        ),
                                                        {
                                                            childInvoice: true,
                                                            qtyCases: Value(Self.Text),
                                                            casesPrice: PriceLine.'Sales Price' * Value(Self.Text),
                                                            caseUnitPrice: PriceLine.'Sales Price',
                                                            price: PriceLine.'Sales Price' * Value(Self.Text),
                                                            discountCases: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            discount: If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            ),
                                                            discountedPriceCases: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))),
                                                            discountedPrice: ((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))),
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            taxAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01),
                                                            cessValue: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cess * 0.01,
                                                            cgstValue: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).cgst * 0.01,
                                                            sgstValue: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).sgst * 0.01,
                                                            netAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) + ((((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) + ((((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / (1 + (LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)))) * LookUp(
                                                                colChildInvoiceLine,
                                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                                            ).tax * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ))
                                                        }
                                                    );
                                                );
                                                ,
                                             ///////////////////////////////////////////////////_____________________ Create collection
                                                With(
                                                    {
                                                        DiscountLine: LookUp(
                                                            varOfflineDiscountLines,
                                                            'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && IsToday('Discount Date') && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE && Customer.Account = varOrderData.Account
                                                        ),
                                                        PriceLine: LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ),
                                                        OrderLinesSum: Sum(
                                                            Filter(
                                                                colOfflineOrderLines As Item,
                                                                (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                            ),
                                                            'Total Quantity'
                                                        ),
                                                        taxStructure: LookUp(
                                                            'HSN Masters' As ItemHsn,
                                                            ItemHsn.'HSN Code' = varHSN/*LookUp(
                                                                'SKU Masters',
                                                                'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                            ).'HSN Code'.'HSN Code'*/
                                                        )
                                                    },
                                                    Collect(
                                                        colChildInvoiceLine,
                                                        {
                                                            childInvoice: true,
                                                            productId: ThisItem.'Item SKU'.'SKU Master',
                                                            qtyCases: Value(Self.Text),
                                                            caseUnitPrice: PriceLine.'Sales Price',
                                                            pcsUnitPrice: 0,
                                                            qtyPcs: Value(""),
                                                            discountPcs: "0",
                                                            discountCases: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            discount: (If(
                                                                OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                "0",
                                                                OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                If(
                                                                    Value(Self.Text) <= (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                    Value(Self.Text) > (DiscountLine.'Maximum Quantity' - OrderLinesSum),
                                                                    ((DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum))
                                                                )
                                                            )),
                                                            maxQty: DiscountLine.'Maximum Quantity',
                                                            casesPrice: PriceLine.'Sales Price' * Value(Self.Text),
                                                            pcsPrice: 0,
                                                            price: PriceLine.'Sales Price' * Value(Self.Text),
                                                            discountedPrice: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))),
                                                            discountedPriceCases: (((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))),
                                                            discountedPricePcs: 0,
                                                            emptyJar: Value(""),
                                                            emptyJarValue: If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) - LookUp(
                                                                    colChildInvoiceLine,
                                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                                ).emptyJar) * 150,
                                                                0
                                                            ),
                                                            schemeOrder: false,
                                                            uom: "Cases",
                                                            schemeOrderValue: Blank(),
                                                            tax: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ),
                                                            cess: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            ),
                                                            sgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            ),
                                                            cgst: If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            ),
                                                            cessValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' * 0),
                                                                taxStructure.CESS
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            cgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.CGST
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            sgstValue: (((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %' / 2),
                                                                taxStructure.'SGST/UGST (zx_sgstugst)'
                                                            )) * 0.01) * ((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            ))) / ((If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01) + 1),
                                                            taxAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01),
                                                            netAmount: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) + (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            )),
                                                            netAmountWithoutEJar: (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01))))) + (((((PriceLine.'Sales Price' * Value(Self.Text)) - Value(
                                                                If(
                                                                    OrderLinesSum >= DiscountLine.'Maximum Quantity',
                                                                    "0",
                                                                    OrderLinesSum < DiscountLine.'Maximum Quantity',
                                                                    If(
                                                                        Value(Self.Text) <= DiscountLine.'Maximum Quantity' - OrderLinesSum,
                                                                        (DiscountLine.'Discount Amount') * Value(Self.Text),
                                                                        (DiscountLine.'Discount Amount') * (DiscountLine.'Maximum Quantity' - OrderLinesSum)
                                                                    )
                                                                )
                                                            )) / ((1 + (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            ) * 0.01)))) * (If(
                                                                LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax Case' = 'Exceptional Tax Case (SKU Masters)'.Yes,
                                                                (LookUp(
                                                                    colOfflineVariantMaster,
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Exceptional Tax %'),
                                                                (taxStructure.CESS + taxStructure.CGST + taxStructure.IGST + taxStructure.'SGST/UGST (zx_sgstugst)')
                                                            )) * 0.01)) + If(
                                                                LookUp(
                                                                    'SKU Masters',
                                                                    'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                                ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                                (Value(Self.Text) * 150),
                                                                0
                                                            ))
                                                        }
                                                    );
                                                )
                                            );
                                    //_____________________________________________________________________________________________SCHEME MODULE
                                If(
                                                CountRows(colSchemeApplicability) > 0,
                                                Collect(
                                                    colSchemeOrder,
                                                    Sort(
                                                        Filter(
                                                            'Scheme Orders',
                                                            ('Scheme Code'.'Scheme Header' in/*AddColumns(
                                                                colSchemeHeader,
                                                                "SchemeCode",
                                                                'Scheme Header'
                                                            ).SchemeCode*/ AddColumns(
                                                                colSchemeApplicability,
                                                                "SchemeCode",
                                                                'Scheme Code'.'Scheme Header'
                                                            ).SchemeCode) && ('Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master') 
                                                     //   && ('Ordered Quantity' <= Value(Self.Text)) 
                                && ('Ordered UOM' = 'UOM Choice'.CASE)
                                                        ),
                                                        'Ordered Quantity',
                                                        SortOrder.Ascending
                                                    )
                                                )
                                            );
                                            ForAll(
                                                colSchemeOrder As ThissItemm,
                                                If(
                                                    CountRows(colFinalSchemeOrder) = 0,
                                                    If(
                                                        (ThissItemm.'Ordered Quantity' = Value(Self.Text)),
                                                        Collect(
                                                            colFinalSchemeOrder,
                                                            ThissItemm
                                                        )
                                                    )
                                                )
                                            );
                                            If(
                                                CountRows(colFinalSchemeOrder) = 0,
                                                ForAll(
                                                    colSchemeOrder As ThissItemm,
                                                    If(
                                                        CountRows(colFinalSchemeOrder) = 0,
                                                        If(
                                                            (ThissItemm.'Ordered Quantity' < Value(Self.Text)),
                                                            Collect(
                                                                colFinalSchemeOrder,
                                                                /*First(
                                                                    Sort(
                                                                        Filter(
                                                                            colSchemeOrder,
                                                                            'Ordered Quantity' < Value(Self.Text)
                                                                        ),
                                                                        'Ordered Quantity',
                                                                        SortOrder.Descending
                                                                    )
                                                                )*/
                                                                Index(
                                                                    Sort(
                                                                        Filter(
                                                                            colSchemeOrder,
                                                                            'Ordered Quantity' < Value(Self.Text)
                                                                        ),
                                                                        'Ordered Quantity',
                                                                        SortOrder.Descending
                                                                    ),
                                                                    1
                                                                )
                                                            )
                                                        )
                                                    )
                                                );
                                            );
                                    //_________________________________________________________________________________________________________________
                                If(
                                                Not(CountRows(colFinalSchemeOrder) = 0),
                                                ForAll(
                                                    colFinalSchemeOrder As item,
                                                    Collect(
                                                        colSchemeOffers,
                                                        Filter(
                                                            'Scheme Offers',
                                                            ('Scheme Code'.'Scheme Header' in AddColumns(
                                                                colSchemeHeader,
                                                                "SchemeCode",
                                                                'Scheme Header'
                                                            ).SchemeCode) && ('Scheme Order'.'Scheme Order' in AddColumns(
                                                                colFinalSchemeOrder,
                                                                "SchemeOrder",
                                                                'Scheme Order'
                                                            ).SchemeOrder) && ('Offer Item Code'.'SKU Master' in AddColumns(
                                                                Filter(
                                                                    colOfflineCurrentStock/*'Current Stocks'*/,
                                                                    'Created On' >= Today() && 'Van No'.Warehouse = varUserVanNo.Van.Warehouse
                                                                ),
                                                                "skuID",
                                                                'Item SKU'.'SKU Master'
                                                            ).skuID)
                                                        )
                                                    )
                                                );
                                                
                                //________________________________________________________________________________________________________________________
                                If(
                                                    Not(CountRows(colSchemeOffers) = 0),
                                                    ForAll(
                                                        Table(/*First(colSchemeOffers)*/
                                                            Index(
                                                                colSchemeOffers,
                                                                1
                                                            )
                                                        ) As ThisItemmmm,
                                                        If(
                                                            IsBlank(
                                                                LookUp(
                                                                    colCartItems,
                                                                    childInvoice = false && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                )
                                                            ),
                                                            Collect(
                                                                colCartItems,
                                                                {
                                                                    childInvoice: false,
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    discount: "0",
                                                                    maxQty: 0,
                                                                    price: 0,
                                                                    discountedPrice: 0,
                                                                    emptyJar: Value(""),
                                                                    emptyJarValue: 0,
                                                                    schemeOrder: true,
                                                                    uom: Text(ThisItemmmm.'Offer UOM'),
                                                                    schemeOrderValue: ThisItemmmm,
                                                                    tax: 0,
                                                                    cess: 0,
                                                                    SchemeOrderLine: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ),
                                                                    SchemeOrderProductReference: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                }
                                                            );
                                                            Collect(
                                                                colChildInvoiceLine,
                                                                {
                                                                    childInvoice: true,
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    discount: "0",
                                                                    maxQty: 0,
                                                                    price: 0,
                                                                    discountedPrice: 0,
                                                                    emptyJar: Value(""),
                                                                    emptyJarValue: 0,
                                                                    schemeOrder: true,
                                                                    uom: Text(ThisItemmmm.'Offer UOM'),
                                                                    schemeOrderValue: ThisItemmmm,
                                                                    tax: 0,
                                                                    cess: 0,
                                                                    SchemeOrderLine: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ),
                                                                    SchemeOrderProductReference: LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                }
                                                            ),
                                                            Patch(
                                                                colCartItems,
                                                                LookUp(
                                                                    colCartItems,
                                                                    childInvoice = false && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                ),
                                                                {
                                                                    childInvoice: false,
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    )
                                                                }
                                                            );
                                                            Patch(
                                                                colChildInvoiceLine,
                                                                LookUp(
                                                                    colChildInvoiceLine,
                                                                    childInvoice = true && productId = ThisItemmmm.'Offer Item Code'.'SKU Master' && schemeOrder = true && SchemeOrderProductReference = LookUp(
                                                                        colFinalSchemeOrder,
                                                                        'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                    ).'Item Code'.'SKU Master'
                                                                ),
                                                                {
                                                                    productId: ThisItemmmm.'Offer Item Code'.'SKU Master',
                                                                    qtyCases: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.CASE,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    ),
                                                                    qtyPcs: If(
                                                                        ThisItemmmm.'Offer UOM' = 'UOM Choice'.PCS,
                                                                        (Trunc(
                                                                            ((Value(Self.Text)) / ( LookUp(
                                                                                colFinalSchemeOrder,
                                                                                'Scheme Order' = ThisItemmmm.'Scheme Order'.'Scheme Order'
                                                                            ).'Ordered Quantity'))
                                                                        ) * ThisItemmmm.'Offer Quantity'),
                                                                        Value("")
                                                                    )
                                                                }
                                                            )
                                                        )
                                                    )
                                                );
                                                Clear(colSchemeOffers);
                                                Clear(colSchemeOrder);
                                                Clear(colFinalSchemeOrder);
                                                ,
                                                Remove(
                                                    colCartItems,
                                                    LookUp(
                                                        colCartItems,
                                                        childInvoice = false && schemeOrder = true && SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && SchemeOrderLine.'Ordered UOM' = 'UOM Choice'.CASE
                                                    )
                                                );
                                                Remove(
                                                    colChildInvoiceLine,
                                                    LookUp(
                                                        colChildInvoiceLine,
                                                        childInvoice = true && schemeOrder = true && SchemeOrderProductReference = ThisItem.'Item SKU'.'SKU Master' && SchemeOrderLine.'Ordered UOM' = 'UOM Choice'.CASE
                                                    )
                                                );
                                                Remove(
                                                    'Order Lines',
                                                    LookUp(
                                                        'Order Lines',
                                                        'Order Number'.'Order Id' = collorderheaderdata.'Order Id' && 'Scheme Parent Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Free && 'Scheme Order Item'.'Ordered UOM' = 'UOM Choice'.CASE
                                                    )
                                                );
                                                Remove(
                                                    'Invoice Lines',
                                                    LookUp(
                                                        'Invoice Lines',
                                                        'Order Number'.'Order Id' = collorderheaderdata.'Order Id' && 'Scheme Parent Item Code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && 'Item Type' = 'Item Type (Choice)'.Free && 'Scheme Order Item'.'Ordered UOM' = 'UOM Choice'.CASE
                                                    )
                                                );
                                            );
                                            Clear(colSchemeOffers);
                                            Clear(colSchemeOrder);
                                            Clear(colFinalSchemeOrder);
                                            ,
                                            Notify(
                                                "You are entering an invalid quantity. Please enter a quantity which is available in the stock",
                                                NotificationType.Error,
                                                2000
                                            );
                                            Reset(txtNewOrderRecEmpty);
                                        );
                                    )
                                );
                                Set(
                                    varLoading,
                                    false
                                );
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Subtitle
                            Width: =65
                            X: =395
                            Y: =24
                            ZIndex: =7

                        shpNewOrderDataRectangle1 As rectangle:
                            Fill: |-
                                =//RGBA(56, 96, 178, 1)
                                _VarGblAppColors.LightText
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Width: =2
                            X: =222
                            ZIndex: =10

                        shpNewOrderDataRectangle2 As rectangle:
                            Fill: |-
                                =//RGBA(56, 96, 178, 1)
                                _VarGblAppColors.LightText
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Width: =2
                            X: =303
                            ZIndex: =11

                        shpNewOrderDataRectangle3 As rectangle:
                            Fill: |-
                                =//RGBA(56, 96, 178, 1)
                                _VarGblAppColors.LightText
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Width: =2
                            X: =385
                            ZIndex: =12

                        txtNewOrderCasesValue As text:
                            AccessibleLabel: ="txtNewOrderActualDel"
                            Align: =Align.Center
                            BorderColor: |-
                                =//RGBA(0, 18, 107, 1)
                                ColorFade( _VarGblAppColors.BisleriBlue, -30%)
                            Default: |-
                                =If(
                                    !IsBlank(
                                        LookUp(
                                            colCartItems,
                                            productId = ThisItem.'Item SKU'.'SKU Master'
                                        ).emptyJar
                                    ),
                                    LookUp(
                                        colCartItems,
                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                    ).emptyJar,
                                   ""
                                )
                            DisplayMode: |-
                                =If(
                                    LookUp(
                                        'SKU Masters',
                                        'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                    ).'Product group code' = 'Product group code (Choice)'.'2WAY' && !IsBlank(
                                        LookUp(
                                            colCartItems,
                                            productId = ThisItem.'Item SKU'.'SKU Master'
                                        )
                                    ),
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            FocusedBorderThickness: =2
                            FontWeight: =FontWeight.Semibold
                            Format: =TextFormat.Number
                            Height: =50
                            HoverBorderColor: =ColorFade( _VarGblAppColors.BisleriBlue, 30%)
                            HoverFill: |-
                                =//RGBA(186, 202, 226, 1)
                                ColorFade(_VarGblAppColors.BisleriBlue, 100%)
                            OnChange: |-
                                =If(
                                    Self.Text <> "" And Value(Self.Text) <> RoundDown(
                                        Value(Self.Text),
                                        0
                                    ) Or Value(Self.Text) < 0,
                                    Notify(
                                        "Please enter whole number",
                                        NotificationType.Information,
                                        1000
                                    );
                                    Reset(Self),
                                    If(
                                        !IsBlank(
                                            LookUp(
                                                colCartItems,
                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                            )
                                        ),
                                        With(
                                            {
                                                DiscountLine: LookUp(
                                                    varOfflineDiscountLines,
                                                    'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && 'Discount Date' = Today() && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                ),
                                                PriceLine: If(
                                                    IsBlank(
                                                        LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                        ).'Base Price'
                                                    ),
                                                    Round(
                                                        LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ).'Base Price' / LookUp(
                                                            'Item UOMS',
                                                            SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                        ).'Quantity Per UOM',
                                                        0
                                                    ),
                                                    LookUp(
                                                        varOfflinePricingLines,
                                                        'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                    ).'Base Price'
                                                ),
                                                OrderLinesSum: Sum(
                                                    Filter(
                                                        colOfflineOrderLines As Item,
                                                        (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                    ),
                                                    'Total Quantity'
                                                )
                                            },
                                            Patch(
                                                colCartItems,
                                                LookUp(
                                                    colCartItems,
                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                ),
                                                {
                                                    emptyJar: Value(Self.Text),
                                                    emptyJarValue: (LookUp(
                                                        colCartItems,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).qtyPcs - Value(Self.Text)) * 150,
                                                    netAmount: ((LookUp(
                                                        colCartItems,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).discountedPrice) + ((LookUp(
                                                        colCartItems,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).taxAmount)) + If(
                                                        LookUp(
                                                            'SKU Masters',
                                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                        ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                        ((LookUp(
                                                            colCartItems,
                                                            productId = ThisItem.'Item SKU'.'SKU Master'
                                                        ).qtyPcs - Value(Self.Text)) * 150),
                                                        0
                                                    ))
                                                }
                                            );
                                        );
                                    );
                                    If(
                                        !IsBlank(
                                            LookUp(
                                                colChildInvoiceLine,
                                                productId = ThisItem.'Item SKU'.'SKU Master'
                                            )
                                        ),
                                        With(
                                            {
                                                DiscountLine: LookUp(
                                                    varOfflineDiscountLines,
                                                    'Discount header'.'Discount Header' = varDiscountHeader.'Discount Header' && 'Discount Date' = Today() && Variant.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.PCS && Customer.Account = varOrderData.Account
                                                ),
                                                PriceLine: If(
                                                    IsBlank(
                                                        LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                        ).'Base Price'
                                                    ),
                                                    Round(
                                                        LookUp(
                                                            varOfflinePricingLines,
                                                            'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.CASE
                                                        ).'Base Price' / LookUp(
                                                            'Item UOMS',
                                                            SKU.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM Choice'.CASE
                                                        ).'Quantity Per UOM',
                                                        0
                                                    ),
                                                    LookUp(
                                                        varOfflinePricingLines,
                                                        'Item price header'.'Item pricing master' = varPricingMaster.'Item pricing master' && 'Variant code'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && UOM = 'UOM (Item Pricing lines)'.PCS
                                                    ).'Base Price'
                                                ),
                                                OrderLinesSum: Sum(
                                                    Filter(
                                                        colOfflineOrderLines As Item,
                                                        (Item.'Customer no.'.Account = varOrderData.Account) && Item.'Item SKU'.'SKU Master' = ThisItem.'Item SKU'.'SKU Master' && (IsToday(Item.'Created On'))
                                                    ),
                                                    'Total Quantity'
                                                )
                                            },
                                            Patch(
                                                colChildInvoiceLine,
                                                LookUp(
                                                    colChildInvoiceLine,
                                                    productId = ThisItem.'Item SKU'.'SKU Master'
                                                ),
                                                {
                                                    emptyJar: Value(Self.Text),
                                                    emptyJarValue: (LookUp(
                                                        colChildInvoiceLine,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).qtyPcs - Value(Self.Text)) * 150,
                                                    netAmount: ((LookUp(
                                                        colChildInvoiceLine,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).discountedPrice) + ((LookUp(
                                                        colChildInvoiceLine,
                                                        productId = ThisItem.'Item SKU'.'SKU Master'
                                                    ).taxAmount)) + If(
                                                        LookUp(
                                                            'SKU Masters',
                                                            'SKU Master' = ThisItem.'Item SKU'.'SKU Master'
                                                        ).'Product group code' = 'Product group code (Choice)'.'2WAY',
                                                        ((LookUp(
                                                            colChildInvoiceLine,
                                                            productId = ThisItem.'Item SKU'.'SKU Master'
                                                        ).qtyPcs - Value(Self.Text)) * 150),
                                                        0
                                                    ))
                                                }
                                            );
                                        );
                                    );
                                    
                                )
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Subtitle
                            Width: =65
                            X: =558
                            Y: =24
                            ZIndex: =13

                        lblNewOrderProductDescription As label:
                            Align: =Align.Center
                            FontWeight: =FontWeight.Semibold
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Tiny
                            Text: =ThisItem.'Item SKU'.'Item Description'
                            Width: =220
                            Y: =60
                            ZIndex: =14

                        shpNewOrderDataRectangle3_1 As rectangle:
                            Fill: |-
                                =//RGBA(56, 96, 178, 1)
                                _VarGblAppColors.LightText
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Width: =2
                            X: =468
                            ZIndex: =15

                        shpNewOrderDataRectangle3_2 As rectangle:
                            Fill: |-
                                =//RGBA(56, 96, 178, 1)
                                _VarGblAppColors.LightText
                            Height: =galNewOrderProduct.TemplateHeight
                            OnSelect: =Select(Parent)
                            Width: =2
                            X: =550
                            ZIndex: =16

                        Label1 As label:
                            Align: =Align.Center
                            FontWeight: =FontWeight.Bold
                            Height: =55
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Subtitle
                            Text: =ThisItem.Cases
                            Width: =75
                            X: =224
                            Y: =22
                            ZIndex: =17

                        Label1_1 As label:
                            Align: =Align.Center
                            FontWeight: =FontWeight.Bold
                            Height: =55
                            OnSelect: =Select(Parent)
                            Size: =_VarGblAppFonts.Size.Subtitle
                            Text: =ThisItem.PCs
                            Width: =75
                            X: =308
                            Y: =22
                            ZIndex: =18

    btnNewOrderBackground As button:
        DisabledFill: |-
            =//RGBA(244, 244, 244, 1)
            _VarGblAppColors.LightText
        DisplayMode: =DisplayMode.Disabled
        Height: =262
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Size: =24
        Text: =""
        Width: =554
        X: =43
        Y: =539
        ZIndex: =2

    lblNewOrderDate As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Total Qty(Cases) :"
        Width: =195
        X: =114
        Y: =576
        ZIndex: =3

    lblNewOrderQty As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Total Qty(Pcs) :"
        Width: =195
        X: =114
        Y: =614
        ZIndex: =4

    lblNewOrderOrder As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Order Value :"
        Width: =208
        X: =114
        Y: =652
        ZIndex: =5

    lblNewOrderEmptyJar As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Empty Jar Value :"
        Width: =208
        X: =114
        Y: =690
        ZIndex: =6

    lblNewOrderDiscount As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Discount :"
        Width: =184
        X: =114
        Y: =728
        ZIndex: =7

    lblNewOrderDateValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: =Sum(colCartItems, qtyCases)
        X: =353
        Y: =576
        ZIndex: =8

    lblNewOrderQtyValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: =Sum(colCartItems, qtyPcs)
        X: =353
        Y: =614
        ZIndex: =9

    lblNewOrderOrderValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            =Concatenate(
                "",
                Text(
                    Sum(
                        colCartItems,
                        discountedPrice
                    ) + Sum(
                        colCartItems,
                        taxAmount
                    ),
                    "[$-hi-IN]##,##,##,###",
                    "hi-IN"
                )
            )
        X: =353
        Y: =652
        ZIndex: =10

    lblNewOrderEmptyJarValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            =Concatenate(
                "",
                Text(
                    Sum(
                        colCartItems,
                        emptyJarValue
                    ),
                    "[$-hi-IN]##,##,##,###",
                    "hi-IN"
                )
            )
        X: =353
        Y: =690
        ZIndex: =11

    lblNewOrderDiscountValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            =Concatenate(
                "",
                Text(
                    Sum(
                        colCartItems,
                        discount
                    ),
                    "[$-hi-IN]##,##,##,###",
                    "hi-IN"
                )
            )
        X: =353
        Y: =728
        ZIndex: =12

    lblNewOrderTotalOrder As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Total Order Value :"
        Width: =220
        X: =114
        Y: =766
        ZIndex: =13

    lblNewOrderTotalOrderValue As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            =/*Concatenate(
                "",
                Text(
                    Sum(
                        colCartItems,
                        discountedPrice
                    ) + Sum(
                        colCartItems,
                        emptyJarValue
                    ),
                    "[$-hi-IN]##,##,##,###",
                    "hi-IN"
                )
            )*/
            Concatenate(
                "",
                Text(
                     Sum(
                        colCartItems,
                        netAmount
                    ),
                    "[$-hi-IN]##,##,##,###",
                    "hi-IN"
                )
            )
        X: =353
        Y: =766
        ZIndex: =14

    Button1 As button:
        Fill: =_VarGblAppColors.BisleriBlue
        HoverFill: =ColorFade(_VarGblAppColors.BisleriBlue, -20%)
        Size: =_VarGblAppFonts.Size.UpperMedium
        Text: ="Confirm"
        Visible: =false
        Width: =150
        X: =245
        Y: =844
        ZIndex: =15

    lblNewOrderQty_2 As label:
        FontWeight: =FontWeight.Semibold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: |-
            ="Order Date :"
        Width: =184
        X: =114
        Y: =539
        ZIndex: =16

    lblNewOrderQtyValue_2 As label:
        Color: |-
            =//RGBA(0, 0, 0, 1)
            _VarGblAppColors.PrimaryRed
        FontWeight: =FontWeight.Bold
        Height: =30
        Size: =_VarGblAppFonts.Size.Medium
        Text: =Text(DateValue(Today()), "dd mmm yyyy")
        X: =353
        Y: =539
        ZIndex: =17

